<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, minimal-ui">
<meta name="application-name" content="Embiggen">
<meta name="theme-color" content="white">
<meta name="msapplication-TileColor" content="white">
<meta name="msapplication-navbutton-color" content="white">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="white">

<link rel="icon" type="image/png" sizes="256x256" href="icon-256x256.png">

<title>Embiggen</title>

<span id="edit"></span>

<script src="screenfull.js"></script>

<script>
(function () {

/* Add event handlers */

var KEY_ENTER = 13;
var KEY_ESC = 27;
var KEY_F11 = 122;

// Callback
function handler (e) {
	e.preventDefault();
	screenfull.toggle(document.body);
}

// When pressing Alt+Enter
window.addEventListener('keydown', function (e) {
	if (e.altKey && e.which === KEY_ENTER) {
		handler(e);
	}
});

// When pressing F11
window.addEventListener('keydown', function (e) {
	if (!e.shiftKey && !e.ctrlKey && !e.altKey && !e.metaKey && e.which === KEY_F11) {
		handler(e);
	}
});

// When pressing ESC
window.addEventListener('keydown', function (e) {
	if (e.which === KEY_ESC) {
		screenfull.exit();
	}
});

})();
</script>

<script>
(function () {

const LOCAL_STORAGE_KEY = 'embiggen-initial-value';
const DEFAULT_VALUE = 'Edit me';

const editor = document.getElementById('edit');
const parent = document.body;

function zoom (value) {
	parent.style.transform = `scale(${value}, ${value})`;
}

function resize () {
	const editorWidth = editor.offsetWidth;
	const editorHeight = editor.offsetHeight;
	const documentWidth = parent.offsetWidth;
	const documentHeight = parent.offsetHeight;
	const zoomRatioWidth = documentWidth / editorWidth;
	const zoomRatioHeight = documentHeight / editorHeight;
	const zoomRatioMin = Math.min(zoomRatioWidth, zoomRatioHeight);
	zoom(zoomRatioMin);
}

function saveValue () {
	const value = editor.innerHTML;
	localStorage.setItem(LOCAL_STORAGE_KEY, value);
}

function loadValue () {
	const value = localStorage.getItem(LOCAL_STORAGE_KEY);
	editor.innerHTML = value || DEFAULT_VALUE;
}

editor.contentEditable = true;
editor.spellcheck = false;

editor.addEventListener('input', saveValue);
editor.addEventListener('input', resize);
window.addEventListener('resize', resize);
window.addEventListener('mousedown', () => {
	editor.focus();
});

document.addEventListener('DOMContentLoaded', () => {
	resize();
	editor.focus();
});

loadValue();

})();
</script>

<style>
html,
body {
	margin: 0;
	padding: 0;
	width: 100%;
	height: 100%;
	transform-origin: 0 0;
	font-size: 18px;
	overflow: hidden;
	cursor: text;
	line-height: 0.95em;
	font-family: Arial, sans-serif;
	background-color: #fff;
}

#edit {
	width: 100%;
	height: 100%;
	outline: none;
	transform-origin: 0 0;
}
</style>
